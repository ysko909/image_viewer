{% extends 'layout.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="slideshow-container">
    <img id="slideshow-image" src="" alt="Slideshow Image" style="max-width: 100%; max-height: 80vh;">
</div>

<script id="slideshow-data" type="application/json">
{{ { 'image_files': image_files, 'start_index': start_index, 'slideshow_duration': slideshow_duration } | tojson }}
</script>

<script>
    const slideshowData = JSON.parse(document.getElementById('slideshow-data').textContent);
    const imageFiles = slideshowData.image_files;
    let currentIndex = slideshowData.start_index;
    const slideshowImage = document.getElementById('slideshow-image');
    const displayDuration = slideshowData.slideshow_duration;

    function displayImage(index) {
        if (index >= 0 && index < imageFiles.length) {
            const filename = imageFiles[index];
            slideshowImage.src = "{{ url_for('static', filename='img/') }}" + filename;
        }
    }

    function nextImage() {
        currentIndex++;
        if (currentIndex < imageFiles.length) {
            displayImage(currentIndex);
            setTimeout(nextImage, displayDuration);
        } else {
            // End of slideshow, redirect to image list
            window.location.href = "{{ url_for('image_list') }}";
        }
    }

    // Start slideshow
    displayImage(currentIndex);
    setTimeout(nextImage, displayDuration);

</script>
{% endblock %}